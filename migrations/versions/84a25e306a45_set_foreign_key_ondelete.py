"""set foreign key ondelete

Revision ID: 84a25e306a45
Revises: 310f03145878
Create Date: 2020-02-09 15:52:59.695386

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '84a25e306a45'
down_revision = '310f03145878'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint('finbot_linked_accounts_provider_id_fkey', 'finbot_linked_accounts', type_='foreignkey')
    op.drop_constraint('finbot_linked_accounts_user_account_id_fkey', 'finbot_linked_accounts', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_linked_accounts', 'finbot_providers', ['provider_id'], ['id'], ondelete='CASCADE')
    op.create_foreign_key(None, 'finbot_linked_accounts', 'finbot_user_accounts', ['user_account_id'], ['id'], ondelete='CASCADE')
    op.drop_constraint('finbot_linked_accounts_snapshots_linked_account_id_fkey', 'finbot_linked_accounts_snapshots', type_='foreignkey')
    op.drop_constraint('finbot_linked_accounts_snapshots_snapshot_id_fkey', 'finbot_linked_accounts_snapshots', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_linked_accounts_snapshots', 'finbot_linked_accounts', ['linked_account_id'], ['id'], ondelete='CASCADE')
    op.create_foreign_key(None, 'finbot_linked_accounts_snapshots', 'finbot_user_accounts_snapshots', ['snapshot_id'], ['id'], ondelete='CASCADE')
    op.drop_constraint('finbot_linked_accounts_valuation_his_effective_snapshot_id_fkey', 'finbot_linked_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint('finbot_linked_accounts_valuation_history__history_entry_id_fkey', 'finbot_linked_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint('finbot_linked_accounts_valuation_history_linked_account_id_fkey', 'finbot_linked_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint('finbot_linked_accounts_valuation_histo_valuation_change_id_fkey', 'finbot_linked_accounts_valuation_history_entries', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_linked_accounts_valuation_history_entries', 'finbot_user_accounts_snapshots', ['effective_snapshot_id'], ['id'], ondelete='SET NULL')
    op.create_foreign_key(None, 'finbot_linked_accounts_valuation_history_entries', 'finbot_user_accounts_history_entries', ['history_entry_id'], ['id'], ondelete='CASCADE')
    op.create_foreign_key(None, 'finbot_linked_accounts_valuation_history_entries', 'finbot_valuation_change_entries', ['valuation_change_id'], ['id'], ondelete='SET NULL')
    op.create_foreign_key(None, 'finbot_linked_accounts_valuation_history_entries', 'finbot_linked_accounts', ['linked_account_id'], ['id'], ondelete='CASCADE')
    op.drop_constraint('finbot_sub_accounts_items_sna_sub_account_snapshot_entry_i_fkey', 'finbot_sub_accounts_items_snapshot_entries', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_sub_accounts_items_snapshot_entries', 'finbot_sub_accounts_snapshot_entries', ['sub_account_snapshot_entry_id'], ['id'], ondelete='CASCADE')
    op.drop_constraint('finbot_sub_accounts_items_valuation_hist_linked_account_id_fkey', 'finbot_sub_accounts_items_valuation_history_entries', type_='foreignkey')
    op.drop_constraint('finbot_sub_accounts_items_valuation_histo_history_entry_id_fkey', 'finbot_sub_accounts_items_valuation_history_entries', type_='foreignkey')
    op.drop_constraint('finbot_sub_accounts_items_valuation_hi_valuation_change_id_fkey', 'finbot_sub_accounts_items_valuation_history_entries', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_sub_accounts_items_valuation_history_entries', 'finbot_linked_accounts', ['linked_account_id'], ['id'], ondelete='CASCADE')
    op.create_foreign_key(None, 'finbot_sub_accounts_items_valuation_history_entries', 'finbot_user_accounts_history_entries', ['history_entry_id'], ['id'], ondelete='CASCADE')
    op.create_foreign_key(None, 'finbot_sub_accounts_items_valuation_history_entries', 'finbot_valuation_change_entries', ['valuation_change_id'], ['id'], ondelete='SET NULL')
    op.drop_constraint('finbot_sub_accounts_snapshot__linked_account_snapshot_entr_fkey', 'finbot_sub_accounts_snapshot_entries', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_sub_accounts_snapshot_entries', 'finbot_linked_accounts_snapshots', ['linked_account_snapshot_entry_id'], ['id'], ondelete='CASCADE')
    op.drop_constraint('finbot_sub_accounts_valuation_history_en_linked_account_id_fkey', 'finbot_sub_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint('finbot_sub_accounts_valuation_history_ent_history_entry_id_fkey', 'finbot_sub_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint('finbot_sub_accounts_valuation_history__valuation_change_id_fkey', 'finbot_sub_accounts_valuation_history_entries', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_sub_accounts_valuation_history_entries', 'finbot_linked_accounts', ['linked_account_id'], ['id'], ondelete='CASCADE')
    op.create_foreign_key(None, 'finbot_sub_accounts_valuation_history_entries', 'finbot_user_accounts_history_entries', ['history_entry_id'], ['id'], ondelete='CASCADE')
    op.create_foreign_key(None, 'finbot_sub_accounts_valuation_history_entries', 'finbot_valuation_change_entries', ['valuation_change_id'], ['id'], ondelete='SET NULL')
    op.drop_constraint('finbot_user_accounts_history_entries_user_account_id_fkey', 'finbot_user_accounts_history_entries', type_='foreignkey')
    op.drop_constraint('finbot_user_accounts_history_entries_source_snapshot_id_fkey', 'finbot_user_accounts_history_entries', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_user_accounts_history_entries', 'finbot_user_accounts', ['user_account_id'], ['id'], ondelete='CASCADE')
    op.create_foreign_key(None, 'finbot_user_accounts_history_entries', 'finbot_user_accounts_snapshots', ['source_snapshot_id'], ['id'], ondelete='SET NULL')
    op.drop_constraint('finbot_user_accounts_settings_user_account_id_fkey', 'finbot_user_accounts_settings', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_user_accounts_settings', 'finbot_user_accounts', ['user_account_id'], ['id'], ondelete='CASCADE')
    op.drop_constraint('finbot_user_accounts_snapshots_user_account_id_fkey', 'finbot_user_accounts_snapshots', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_user_accounts_snapshots', 'finbot_user_accounts', ['user_account_id'], ['id'], ondelete='CASCADE')
    op.drop_constraint('finbot_user_accounts_valuation_history_en_history_entry_id_fkey', 'finbot_user_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint('finbot_user_accounts_valuation_history_valuation_change_id_fkey', 'finbot_user_accounts_valuation_history_entries', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_user_accounts_valuation_history_entries', 'finbot_user_accounts_history_entries', ['history_entry_id'], ['id'], ondelete='CASCADE')
    op.create_foreign_key(None, 'finbot_user_accounts_valuation_history_entries', 'finbot_valuation_change_entries', ['valuation_change_id'], ['id'], ondelete='SET NULL')
    op.drop_constraint('finbot_xccy_rates_snapshots_snapshot_id_fkey', 'finbot_xccy_rates_snapshots', type_='foreignkey')
    op.create_foreign_key(None, 'finbot_xccy_rates_snapshots', 'finbot_user_accounts_snapshots', ['snapshot_id'], ['id'], ondelete='CASCADE')
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, 'finbot_xccy_rates_snapshots', type_='foreignkey')
    op.create_foreign_key('finbot_xccy_rates_snapshots_snapshot_id_fkey', 'finbot_xccy_rates_snapshots', 'finbot_user_accounts_snapshots', ['snapshot_id'], ['id'])
    op.drop_constraint(None, 'finbot_user_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint(None, 'finbot_user_accounts_valuation_history_entries', type_='foreignkey')
    op.create_foreign_key('finbot_user_accounts_valuation_history_valuation_change_id_fkey', 'finbot_user_accounts_valuation_history_entries', 'finbot_valuation_change_entries', ['valuation_change_id'], ['id'])
    op.create_foreign_key('finbot_user_accounts_valuation_history_en_history_entry_id_fkey', 'finbot_user_accounts_valuation_history_entries', 'finbot_user_accounts_history_entries', ['history_entry_id'], ['id'])
    op.drop_constraint(None, 'finbot_user_accounts_snapshots', type_='foreignkey')
    op.create_foreign_key('finbot_user_accounts_snapshots_user_account_id_fkey', 'finbot_user_accounts_snapshots', 'finbot_user_accounts', ['user_account_id'], ['id'])
    op.drop_constraint(None, 'finbot_user_accounts_settings', type_='foreignkey')
    op.create_foreign_key('finbot_user_accounts_settings_user_account_id_fkey', 'finbot_user_accounts_settings', 'finbot_user_accounts', ['user_account_id'], ['id'])
    op.drop_constraint(None, 'finbot_user_accounts_history_entries', type_='foreignkey')
    op.drop_constraint(None, 'finbot_user_accounts_history_entries', type_='foreignkey')
    op.create_foreign_key('finbot_user_accounts_history_entries_source_snapshot_id_fkey', 'finbot_user_accounts_history_entries', 'finbot_user_accounts_snapshots', ['source_snapshot_id'], ['id'])
    op.create_foreign_key('finbot_user_accounts_history_entries_user_account_id_fkey', 'finbot_user_accounts_history_entries', 'finbot_user_accounts', ['user_account_id'], ['id'])
    op.drop_constraint(None, 'finbot_sub_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint(None, 'finbot_sub_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint(None, 'finbot_sub_accounts_valuation_history_entries', type_='foreignkey')
    op.create_foreign_key('finbot_sub_accounts_valuation_history__valuation_change_id_fkey', 'finbot_sub_accounts_valuation_history_entries', 'finbot_valuation_change_entries', ['valuation_change_id'], ['id'])
    op.create_foreign_key('finbot_sub_accounts_valuation_history_ent_history_entry_id_fkey', 'finbot_sub_accounts_valuation_history_entries', 'finbot_user_accounts_history_entries', ['history_entry_id'], ['id'])
    op.create_foreign_key('finbot_sub_accounts_valuation_history_en_linked_account_id_fkey', 'finbot_sub_accounts_valuation_history_entries', 'finbot_linked_accounts', ['linked_account_id'], ['id'])
    op.drop_constraint(None, 'finbot_sub_accounts_snapshot_entries', type_='foreignkey')
    op.create_foreign_key('finbot_sub_accounts_snapshot__linked_account_snapshot_entr_fkey', 'finbot_sub_accounts_snapshot_entries', 'finbot_linked_accounts_snapshots', ['linked_account_snapshot_entry_id'], ['id'])
    op.drop_constraint(None, 'finbot_sub_accounts_items_valuation_history_entries', type_='foreignkey')
    op.drop_constraint(None, 'finbot_sub_accounts_items_valuation_history_entries', type_='foreignkey')
    op.drop_constraint(None, 'finbot_sub_accounts_items_valuation_history_entries', type_='foreignkey')
    op.create_foreign_key('finbot_sub_accounts_items_valuation_hi_valuation_change_id_fkey', 'finbot_sub_accounts_items_valuation_history_entries', 'finbot_valuation_change_entries', ['valuation_change_id'], ['id'])
    op.create_foreign_key('finbot_sub_accounts_items_valuation_histo_history_entry_id_fkey', 'finbot_sub_accounts_items_valuation_history_entries', 'finbot_user_accounts_history_entries', ['history_entry_id'], ['id'])
    op.create_foreign_key('finbot_sub_accounts_items_valuation_hist_linked_account_id_fkey', 'finbot_sub_accounts_items_valuation_history_entries', 'finbot_linked_accounts', ['linked_account_id'], ['id'])
    op.drop_constraint(None, 'finbot_sub_accounts_items_snapshot_entries', type_='foreignkey')
    op.create_foreign_key('finbot_sub_accounts_items_sna_sub_account_snapshot_entry_i_fkey', 'finbot_sub_accounts_items_snapshot_entries', 'finbot_sub_accounts_snapshot_entries', ['sub_account_snapshot_entry_id'], ['id'])
    op.drop_constraint(None, 'finbot_linked_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint(None, 'finbot_linked_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint(None, 'finbot_linked_accounts_valuation_history_entries', type_='foreignkey')
    op.drop_constraint(None, 'finbot_linked_accounts_valuation_history_entries', type_='foreignkey')
    op.create_foreign_key('finbot_linked_accounts_valuation_histo_valuation_change_id_fkey', 'finbot_linked_accounts_valuation_history_entries', 'finbot_valuation_change_entries', ['valuation_change_id'], ['id'])
    op.create_foreign_key('finbot_linked_accounts_valuation_history_linked_account_id_fkey', 'finbot_linked_accounts_valuation_history_entries', 'finbot_linked_accounts', ['linked_account_id'], ['id'])
    op.create_foreign_key('finbot_linked_accounts_valuation_history__history_entry_id_fkey', 'finbot_linked_accounts_valuation_history_entries', 'finbot_user_accounts_history_entries', ['history_entry_id'], ['id'])
    op.create_foreign_key('finbot_linked_accounts_valuation_his_effective_snapshot_id_fkey', 'finbot_linked_accounts_valuation_history_entries', 'finbot_user_accounts_snapshots', ['effective_snapshot_id'], ['id'])
    op.drop_constraint(None, 'finbot_linked_accounts_snapshots', type_='foreignkey')
    op.drop_constraint(None, 'finbot_linked_accounts_snapshots', type_='foreignkey')
    op.create_foreign_key('finbot_linked_accounts_snapshots_snapshot_id_fkey', 'finbot_linked_accounts_snapshots', 'finbot_user_accounts_snapshots', ['snapshot_id'], ['id'])
    op.create_foreign_key('finbot_linked_accounts_snapshots_linked_account_id_fkey', 'finbot_linked_accounts_snapshots', 'finbot_linked_accounts', ['linked_account_id'], ['id'])
    op.drop_constraint(None, 'finbot_linked_accounts', type_='foreignkey')
    op.drop_constraint(None, 'finbot_linked_accounts', type_='foreignkey')
    op.create_foreign_key('finbot_linked_accounts_user_account_id_fkey', 'finbot_linked_accounts', 'finbot_user_accounts', ['user_account_id'], ['id'])
    op.create_foreign_key('finbot_linked_accounts_provider_id_fkey', 'finbot_linked_accounts', 'finbot_providers', ['provider_id'], ['id'])
    # ### end Alembic commands ###
